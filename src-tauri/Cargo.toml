# Cargo.toml for the BambooClaw Companion App (Tauri v1 Backend)
#
# This file defines the Rust backend's metadata, dependencies, and build profiles.
# It is configured for a cross-platform Tauri desktop application that handles
# asynchronous operations, file system interactions, and network requests.

# CRITICAL: This empty workspace declaration is mandatory.
# It prevents Cargo from mistakenly linking this crate to a parent workspace,
# ensuring it's treated as a standalone project root for the backend.
[workspace]

[package]
name = "bambooclaw-app"
version = "0.1.0"
description = "Installer and management companion for BambooClaw AI Agents"
authors = ["Bamboo Synergy Technologies"]
license = "MIT"
repository = "https://github.com/bamboosynergy/bambooclaw-installer"
edition = "2021"

# Specifies the entry point for the application binary.
[[bin]]
name = "bambooclaw-app"
path = "src/main.rs"

# Defines dependencies needed only during the build process.
[build-dependencies]
tauri-build = { version = "1.5", features = [] }

# Defines the core runtime dependencies for the application.
[dependencies]
# The main Tauri framework for building the desktop application.
tauri = { version = "1.6", features = [] }

# Serde is used for serializing and deserializing data structures,
# essential for communicating between the Rust backend and the web frontend.
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"

# Tokio is an asynchronous runtime for Rust, crucial for handling
# non-blocking operations like network requests and file I/O without
# freezing the UI. The "full" feature set provides all necessary utilities.
tokio = { version = "1", features = ["full"] }

# `dirs` provides a cross-platform way to find standard system directories,
# such as the user's home or config directory. This is vital for storing
# downloaded binaries and configuration files in the correct location.
dirs = "5.0"

# `reqwest` is a powerful and ergonomic HTTP client. The "stream" feature
# is enabled to handle large file downloads (like AI models or agent binaries)
# efficiently, allowing for progress tracking.
reqwest = { version = "0.12", features = ["stream"] }

[features]
# This feature is used by Tauri for bundling and is required for many production setups.
# It enables the WebView to load assets from a custom protocol (e.g., tauri://)
# instead of a local HTTP server, enhancing security and performance.
custom-protocol = ["tauri/custom-protocol"]

# Configures build settings specifically for the release profile.
# These optimizations are crucial for producing a small, fast, and secure
# production binary for distribution to end-users.
[profile.release]
panic = "abort"      # Abort on panic for smaller binaries.
codegen-units = 1    # Maximize optimizations by using a single codegen unit.
lto = true           # Enable Link-Time Optimization to optimize across crates.
opt-level = "s"      # Optimize for binary size ("s") or "z" for even smaller.
strip = true         # Strip symbols from the binary to further reduce its size.